var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},MapPoint=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.getNeighbor=function(t){return new e(this.x+Direction.getXDelta(t),this.y+Direction.getYDelta(t))},e.prototype.toString=function(){return"MapPoint: "+this.x+"-"+this.y},e.prototype.equals=function(e){return this.x===e.x&&this.y===e.y},e}(),ScreenPoint=function(){function e(e,t){this.x=e,this.y=t}return e}(),Direction;!function(e){e[e.NW=0]="NW",e[e.NE=1]="NE",e[e.SE=2]="SE",e[e.SW=3]="SW"}(Direction||(Direction={})),function(e){function t(e){return(e+1)%4}function n(e){return(e+3)%4}function o(t){switch(t){case e.NW:return-1;case e.SE:return 1;default:return 0}}function i(t){switch(t){case e.NE:return-1;case e.SW:return 1;default:return 0}}e.rotateRight=t,e.rotateLeft=n,e.getXDelta=o,e.getYDelta=i}(Direction||(Direction={}));var CoordinateTransformer=function(){function e(e,t){this.halfTileWidth=e/2,this.halfTileHeight=t/2}return e.prototype.map_to_screen=function(e){var t=(e.x-e.y)*this.halfTileWidth,n=(e.x+e.y)*this.halfTileHeight;return new MapPoint(t,n)},e.prototype.screen_to_map=function(e){var t=(e.x/this.halfTileWidth+e.y/this.halfTileHeight)/2,n=(e.y/this.halfTileHeight-e.x/this.halfTileWidth)/2;return new MapPoint(t,n)},e}(),OBJECT_SPRITE_X_OFFSET=56,OBJECT_SPRITE_Y_OFFSET=-88,GameObject=function(e){function t(t,n,o,i){var a=e.call(this,t,0,0,o)||this;a.model=n,a.passable=i,a.anchor.set(.5,1);var r=WorldConstants.COORDINATE_TRANSFORMER.map_to_screen(a.location);return a.x=r.x+OBJECT_SPRITE_X_OFFSET,a.y=r.y+OBJECT_SPRITE_Y_OFFSET,t.add.existing(a),a}return __extends(t,e),Object.defineProperty(t.prototype,"location",{get:function(){return new MapPoint(this.model.positionX,this.model.positionY)},enumerable:!0,configurable:!0}),t}(Phaser.Sprite),ObjectType;!function(e){function t(e,t){switch(t.type){case"TREE":return new Tree(e,t);case"HOUSE":return new House(e,t);case"ROCK":return new GameObject(e,t,"rock",(!1));case"MUSHROOMS":return new GameObject(e,t,"mushrooms",(!0));default:throw new Error("Unknown object type "+t.type)}}e.instantiate=t}(ObjectType||(ObjectType={}));var GnomeCode=function(){function e(e){this.libraries=e}return e.prototype.executeNextCommand=function(e,t){var n=this;t.forEach(function(t){var o=t.codeStack.pop();if(void 0===o)return void e.killGnome(t,CauseOfDeath.CODE_RAN_OUT);switch(o.type){case CommandType.WALK:e.tryMove(t);break;case CommandType.LEFT:t.rotateLeft();break;case CommandType.RIGHT:t.rotateRight();break;case CommandType.ACT:e.doGnomeAction(t);break;case CommandType.CALL_ROUTINE:n.queueUpRoutine(e,t,o)}})},e.prototype.queueUpRoutine=function(e,t,n){var o=this.libraries[n.args[0]];if(!o||!o.length)return void e.killGnome(t,CauseOfDeath.CODE_RAN_OUT);for(var i=o.length;i>=0;i--)t.codeStack.push(o[i])},e}(),Command=function(){function e(e,t){void 0===t&&(t=[]),this.type=e,this.args=t}return e}(),CommandType;!function(e){e[e.WALK=0]="WALK",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.ACT=3]="ACT",e[e.CALL_ROUTINE=4]="CALL_ROUTINE"}(CommandType||(CommandType={})),function(e){function t(t){switch(t){case e.WALK:return"commandMoveForward";case e.LEFT:return"commandTurnLeft";case e.RIGHT:return"commandTurnRight";case e.ACT:return"commandPerformAction";default:return"unknownCommandType"}}function n(t){switch(t){case"W":return new Command(e.WALK);case"L":return new Command(e.LEFT);case"R":return new Command(e.RIGHT);case"A":return new Command(e.ACT);default:throw new Error("Cannot parse command "+t)}}e.imageClass=t,e.getCommandTypeForShorthand=n}(CommandType||(CommandType={}));var WorldConstants;!function(e){e.BLOCK_WIDTH=110,e.BLOCK_HEIGHT=68,e.TURN_LENGTH_IN_MILLIS=200,e.COORDINATE_TRANSFORMER=new CoordinateTransformer(e.BLOCK_WIDTH,e.BLOCK_HEIGHT);var t;!function(e){e[e.GRASS=0]="GRASS",e[e.WATER=1]="WATER",e[e.DESERT=2]="DESERT",e[e.STONE=3]="STONE"}(t=e.BlockType||(e.BlockType={}))}(WorldConstants||(WorldConstants={}));var GNOME_X_OFFSET=60,GNOME_Y_OFFSET=-85,Gnome=function(e){function t(t,n,o,i,a){var r=e.call(this,t,0,0,"gnome_regular_front")||this;r.direction=i,r._wateringCan=!1,r.codeStack=a.slice(),r.codeStack.reverse(),r.faceDirection(),r.anchor.set(.5,1),r._location=new MapPoint(n,o);var s=WorldConstants.COORDINATE_TRANSFORMER.map_to_screen(r.location);return r.x=s.x+GNOME_X_OFFSET,r.y=s.y+GNOME_Y_OFFSET,r.game.add.tween(r).from({alpha:0},500,Phaser.Easing.Quartic.Out,!0),t.add.existing(r),r}return __extends(t,e),Object.defineProperty(t.prototype,"location",{get:function(){return this._location},set:function(e){this._location=e,this.tweenToLocation().start()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wateringCan",{get:function(){return this._wateringCan},set:function(e){this._wateringCan=e,this.faceDirection()},enumerable:!0,configurable:!0}),t.prototype.rotateLeft=function(){this.direction=Direction.rotateLeft(this.direction),this.faceDirection()},t.prototype.rotateRight=function(){this.direction=Direction.rotateRight(this.direction),this.faceDirection()},t.prototype.die=function(e){var t=this;this.game.tweens.removeFrom(this);var n=this.tweenToLocation();switch(e){case CauseOfDeath.FALLING:n.onChildComplete.add(function(){(t.location.x<0||t.location.y<0)&&t.sendToBack(),t.game.add.sound("falling_gnome_scream").play()}),n.chain().to({y:this.y+500,alpha:0},500,Phaser.Easing.Quartic.In);break;case CauseOfDeath.DROWNING:n.onChildComplete.add(function(){t.loadTexture("gnome_drowning")}),n.to({alpha:0},500,Phaser.Easing.Quartic.Out);break;case CauseOfDeath.CODE_RAN_OUT:n.to({alpha:0},500,Phaser.Easing.Quartic.Out)}n.start(),n.onComplete.add(function(){return t.destroy(!1)},this)},t.prototype.faceDirection=function(){this.direction===Direction.NE||this.direction===Direction.SW?this.scale.x=-1:this.scale.x=1;var e=this.direction===Direction.SE||this.direction===Direction.SW,t=this.wateringCan?"gnome_water":"gnome_regular",n=t+(e?"_front":"_back");this.loadTexture(n),this.animations.add("walk")},t.prototype.tweenToLocation=function(){this.animations.play("walk",30,!0);var e=this.game.add.tween(this),t=WorldConstants.COORDINATE_TRANSFORMER.map_to_screen(this.location);return e.to({x:t.x+GNOME_X_OFFSET,y:t.y+GNOME_Y_OFFSET},WorldConstants.TURN_LENGTH_IN_MILLIS,Phaser.Easing.Linear.None)},t}(Phaser.Sprite),CauseOfDeath;!function(e){e[e.NOTHING=0]="NOTHING",e[e.FALLING=1]="FALLING",e[e.DROWNING=2]="DROWNING",e[e.CODE_RAN_OUT=3]="CODE_RAN_OUT"}(CauseOfDeath||(CauseOfDeath={}));var TREE_IMAGE_PREFIX="tree-",MAX_TREE_LEVEL=6,Tree=function(e){function t(t,n){var o=e.call(this,t,n,TREE_IMAGE_PREFIX+"1",!1)||this;return o.model=n,n.treeLevel||(n.treeLevel=1),n.requiredWater||o.calculateRequiredWater(),n.waterContent||(n.waterContent=0),o.calculateRequiredWater(),t.add.existing(o),o}return __extends(t,e),Object.defineProperty(t.prototype,"waterContent",{get:function(){return this.model.waterContent},set:function(e){this.model.waterContent=e,this.displayWaterLevel(),this.model.treeLevel<MAX_TREE_LEVEL&&this.waterContent>=this.model.requiredWater&&(this.model.treeLevel++,this.loadTexture(TREE_IMAGE_PREFIX+this.model.treeLevel),this.waterContent=0,this.calculateRequiredWater())},enumerable:!0,configurable:!0}),t.prototype.addWater=function(){this.waterContent=this.waterContent+1},t.prototype.calculateRequiredWater=function(){this.model.treeLevel>=MAX_TREE_LEVEL?this.model.requiredWater=0:this.model.requiredWater=this.model.treeLevel},t.prototype.displayWaterLevel=function(){for(var e=this.y-60,t=this.x-10*this.model.requiredWater,n=function(n){var i=n<o.model.waterContent?"waterdrop_filled":"waterdrop_empty",a=o.game.add.sprite(t+20*n,e,i),r=o.game.add.tween(a).from({alpha:0},50,null,!0),s=o.game.add.tween(a).to({alpha:0},300,null,!1,1e3);s.onComplete.add(function(){return a.destroy(!1)},o),r.chain(s)},o=this,i=0;i<this.model.requiredWater;i++)n(i)},t}(GameObject),VictoryCondition;!function(e){function t(e,t){if(!t)return!1;for(var n=0,o=t;n<o.length;n++){var i=o[n];if(!e.hasOwnProperty(i.name))return!1;if(i.requirementType&&!(e[i.name]>i.value))return!1}return!0}function n(e,n){for(var o=0,i=0,a=n;i<a.length;i++){var r=a[i];e.entityType===r.type&&t(r,e.requiredProperties)&&o++}if(o>0)return!0}e.check=n}(VictoryCondition||(VictoryCondition={}));var Messages;!function(e){function t(e,t){var n=t?t:{},o=document.getElementById("outerMessageArea"),i=document.getElementById("innerMessageArea");o.style.display="block",i.innerText=e;var a=function(){o.style.display="none",n.callback&&n.callback(),o.removeEventListener("click",a)};o.addEventListener("click",a)}e.show=t}(Messages||(Messages={}));var House=function(e){function t(n,o){var i=e.call(this,n,o,t.determineSprite(o.direction),!1)||this;if(i.model=o,i.inputEnabled=!0,i.input.pixelPerfectClick=!0,i.input.useHandCursor=!0,i.gnomeCode=[],o.initialCode)for(var a=0;a<o.initialCode.length;a++)i.gnomeCode.push(CommandType.getCommandTypeForShorthand(o.initialCode.charAt(a)));return n.add.existing(i),i}return __extends(t,e),t.determineSprite=function(e){switch(e){case Direction.NE:return"house_ne";case Direction.NW:return"house_nw";case Direction.SE:return"house_se";case Direction.SW:return"house_sw"}},t}(GameObject),GameWorld=function(){function e(e){this.game=e,this.blockGroup=e.add.group(e.world,"blocks"),this.entityGroup=e.add.group(e.world,"entities"),this.startCodeTimer()}return e.prototype.loadLevel=function(e){var t=this;this.blockGroup.removeAll(!0),this.entityGroup.removeAll(!0),this.gnomes=[],this.gnomeCode=new GnomeCode({}),this.selectionListener&&this.selectionListener();var n=this.game.cache.getJSON(e).LEVEL_DEFINITION;this.level=new Level(n),this.level.renderStage(this.blockGroup),this.level.renderObjects(this.entityGroup),n.introMessage&&Messages.show(n.introMessage),this.level.houses.forEach(function(e){e.events.onInputDown.add(function(){t.selectionListener&&t.selectionListener(e)})})},e.prototype.doGnomeAction=function(e){var t=e.location.getNeighbor(e.direction),n=this.level.getBlock(t);e.wateringCan?this.level.waterObject(t)&&(e.wateringCan=!1):n===WorldConstants.BlockType.WATER&&(e.wateringCan=!0)},e.prototype.tryMove=function(e){var t=e.location.getNeighbor(e.direction),n=this.gnomes.filter(function(e){return e.location.equals(t)}).length;!n&&this.level.pointIsPassable(t)&&(e.location=t,this.determineEntityZIndices());var o=this.level.getPointCauseOfDeath(t);o&&this.killGnome(e,o)},e.prototype.killGnome=function(e,t){this.gnomes.splice(this.gnomes.indexOf(e),1),this.entityGroup.remove(e),this.game.world.add(e),e.die(t)},e.prototype.spawnGnomes=function(){var e=this;this.level.houses.forEach(function(t){var n=new Gnome(e.game,t.model.positionX+Direction.getXDelta(t.model.direction),t.model.positionY+Direction.getYDelta(t.model.direction),t.model.direction,t.gnomeCode);e.entityGroup.add(n),e.gnomes.push(n),e.determineEntityZIndices()})},e.prototype.determineEntityZIndices=function(){this.entityGroup.customSort(function(e,t){var n=e.location.x+e.location.y,o=t.location.x+t.location.y;return n>o?1:n<o?-1:0})},e.prototype.startCodeTimer=function(){var e=this,t=this.game.time.create();t.loop(WorldConstants.TURN_LENGTH_IN_MILLIS,function(){e.gnomeCode.executeNextCommand(e,e.gnomes),e.level.checkVictory()&&e.winLevel()}),t.start()},e.prototype.winLevel=function(){var e=this;Messages.show("You won!",{callback:function(){return e.loadLevel("tutorial_level_2")}})},e}(),Level=function(){function e(e){this.objectMap={},this.houses=[],this.layout=e.layout,this.objects=e.objects,this.victoryConditions=e.victoryConditions}return e.prototype.pointIsPassable=function(e){var t=this.getObject(e);return!t||t.passable},e.prototype.getPointCauseOfDeath=function(e){var t=this.getBlock(e);return null===t?CauseOfDeath.FALLING:t===WorldConstants.BlockType.WATER?CauseOfDeath.DROWNING:CauseOfDeath.NOTHING},e.prototype.getBlock=function(e){return void 0===this.layout[e.y]||void 0===this.layout[e.y][e.x]?null:this.layout[e.y][e.x]},e.prototype.getObject=function(e){return this.objectMap[e.toString()]},e.prototype.checkVictory=function(){if(!this.victoryConditions)return!1;for(var e=0,t=this.victoryConditions;e<t.length;e++){var n=t[e];if(!VictoryCondition.check(n,this.objects))return!1}return!0},e.prototype.waterObject=function(e){var t=this.objectMap[e.toString()];return!(!t||!t.addWater)&&(t.addWater(),!0)},e.prototype.renderStage=function(e){for(var t=this.layout.length,n=this.layout[0].length,o=0;o<t;o++)for(var i=0;i<n;i++)this.renderBlock(e,i,o,this.layout[o][i])},e.prototype.renderObjects=function(e){for(var t=0;t<this.objects.length;t++){var n=this.objects[t],o=this.renderObject(e.game,n);e.add(o),this.objectMap[new MapPoint(n.positionX,n.positionY).toString()]=o}},e.prototype.renderObject=function(e,t){var n=ObjectType.instantiate(e,t);return n instanceof House&&this.houses.push(n),n},e.prototype.renderBlock=function(e,t,n,o){var i=WorldConstants.COORDINATE_TRANSFORMER.map_to_screen(new MapPoint(t,n)),a=e.game.add.sprite(i.x,i.y,this.getBlockSprite(o));a.anchor.y=1,e.add(a)},e.prototype.getBlockSprite=function(e){switch(e){case WorldConstants.BlockType.GRASS:return"stage_block";case WorldConstants.BlockType.WATER:return"water_block";case WorldConstants.BlockType.DESERT:return"desert_block";case WorldConstants.BlockType.STONE:return"stone_block";default:return"stage_block"}},e}(),States;!function(e){var t=-400,n=-300,o=function(e){function o(){return e.apply(this,arguments)||this}return __extends(o,e),o.prototype.init=function(e){this.initialLevel=e||"tutorial_level_1"},o.prototype.create=function(){var e=this;this.game.camera.setPosition(t,n),this.gameWorld=new GameWorld(this.game),this.gameWorld.loadLevel(this.initialLevel),this.initializeSpawnIndicator(),this.initializeButtons(),this.initializeEditor(),this.drawSpawnButton(),document.getElementById("innerCodeEditor").addEventListener("click",function(t){return e.handleCommandClick(t)}),this.gameWorld.selectionListener=function(t){e.selectedSpawnPoint=t,e.toggleSpawnIndicator(t),document.getElementById("gnomeCodeButtons").style.display=t?"block":"none",e.showCodeInEditor()}},o.prototype.initializeButtons=function(){var e=this,t=document.getElementById("gnomeCodeButtons");t.addEventListener("click",function(t){return e.handleCommandButtonClick(t)}),Sortable.create(t,{group:{name:"gnomeCode",pull:"clone",put:!1},sort:!1}),o.appendCommandToGui(t,CommandType.WALK),o.appendCommandToGui(t,CommandType.LEFT),o.appendCommandToGui(t,CommandType.RIGHT),o.appendCommandToGui(t,CommandType.ACT)},o.prototype.initializeEditor=function(){var e=this,t=document.getElementById("innerCodeEditor");this.codeEditorSortable=Sortable.create(t,{group:{name:"gnomeCode",pull:!1,put:!0},animation:150,onSort:function(n){var o=e.selectedSpawnPoint.gnomeCode,i="innerCodeEditor"===n.from.id?o.splice(n.oldIndex,1)[0]:new Command(parseInt(n.item.dataset.commandType));if(o.splice(n.newIndex,0,i),o.length>e.selectedSpawnPoint.model.sizeLimit)for(o.splice(e.selectedSpawnPoint.model.sizeLimit);t.children.length>e.selectedSpawnPoint.model.sizeLimit;)t.removeChild(t.children.item(e.selectedSpawnPoint.model.sizeLimit));e.updateCommandsLabel()}})},o.prototype.showCodeInEditor=function(){var e=document.getElementById("gnomeCodeEditor");if(e.style.display=this.selectedSpawnPoint?"block":"none",this.selectedSpawnPoint){e.classList.toggle("readonly",this.selectedSpawnPoint.model.readonly),e.classList.toggle("editable",!this.selectedSpawnPoint.model.readonly),this.updateCommandsLabel();var t=document.getElementById("innerCodeEditor");t.innerHTML="",this.codeEditorSortable.options.disabled=this.selectedSpawnPoint.model.readonly,this.selectedSpawnPoint.gnomeCode.forEach(function(e){o.appendCommandToGui(t,e.type)})}},o.prototype.updateCommandsLabel=function(){var e=document.getElementById("codeEditorLabel");this.selectedSpawnPoint.model.readonly?e.innerText="This gnome's routine can't be changed":e.innerText=this.selectedSpawnPoint.gnomeCode.length+"/"+this.selectedSpawnPoint.model.sizeLimit+" commands used"},o.prototype.initializeSpawnIndicator=function(){this.spawnIndicator=this.game.add.graphics(0,0),this.spawnIndicator.beginFill(16776960,.3),this.spawnIndicator.moveTo(0,-1e3),this.spawnIndicator.lineTo(0,-100),this.spawnIndicator.lineTo(WorldConstants.BLOCK_WIDTH/2,-100+WorldConstants.BLOCK_HEIGHT/2),this.spawnIndicator.lineTo(WorldConstants.BLOCK_WIDTH,-100),this.spawnIndicator.lineTo(WorldConstants.BLOCK_WIDTH,-1e3),this.spawnIndicator.endFill(),this.spawnIndicator.alpha=0},o.prototype.toggleSpawnIndicator=function(e){if(e){var t=WorldConstants.COORDINATE_TRANSFORMER.map_to_screen(e.location);if(this.spawnIndicator.x===t.x&&this.spawnIndicator.y===t.y)return;this.spawnIndicator.x=t.x,this.spawnIndicator.y=t.y}this.spawnIndicator.alpha=e?0:1,this.game.add.tween(this.spawnIndicator).to({alpha:e?1:0},300,null,!0)},o.prototype.drawSpawnButton=function(){var e=this;this.drawButton(94,10,"play_button",function(){return e.gameWorld.spawnGnomes()})},o.prototype.drawButton=function(e,t,n,o){var i=this.game.add.sprite(e,t,n);return i.inputEnabled=!0,i.fixedToCamera=!0,i.events.onInputDown.add(o,this),i.input.useHandCursor=!0,i},o.prototype.handleCommandButtonClick=function(e){var t=e.target;if(!(!t.classList.contains("commandButton")||this.selectedSpawnPoint.model.readonly||this.selectedSpawnPoint.gnomeCode.length>=this.selectedSpawnPoint.model.sizeLimit)){var n=parseInt(t.dataset.commandType);this.selectedSpawnPoint.gnomeCode.push(new Command(n)),o.appendCommandToGui(document.getElementById("innerCodeEditor"),n),this.updateCommandsLabel()}},o.prototype.handleCommandClick=function(e){var t=e.target;if(t.classList.contains("commandButton")&&!this.selectedSpawnPoint.model.readonly){var n=document.getElementById("innerCodeEditor"),o=Array.prototype.indexOf.call(n.children,t);this.selectedSpawnPoint.gnomeCode.splice(o,1),n.removeChild(t),this.updateCommandsLabel()}},o.appendCommandToGui=function(e,t){var n=document.createElement("DIV");n.classList.add("commandButton"),n.classList.add(CommandType.imageClass(t)),n.dataset.commandType=t.toString(),e.appendChild(n)},o}(Phaser.State);e.PlayState=o}(States||(States={}));var States;!function(e){var t=function(e){function t(){return e.apply(this,arguments)||this}return __extends(t,e),t.prototype.preload=function(){var e=this.game.width/2,t=this.game.height/2,n=this.game.add.sprite(e,t,"logo");n.anchor.set(.5);var o=this.game.add.sprite(e,t+100,"progressBar");o.anchor.set(.5),this.load.setPreloadSprite(o),this.load.image("stage_block","assets/images/stage_block.png"),this.load.image("water_block","assets/images/water_block.png"),this.load.image("desert_block","assets/images/desert_block.png"),this.load.image("stone_block","assets/images/stone_block.png"),this.load.spritesheet("gnome_regular_front","assets/images/gnome_regular_front.png",70,100),this.load.spritesheet("gnome_regular_back","assets/images/gnome_regular_back.png",70,100),this.load.spritesheet("gnome_water_front","assets/images/gnome_water_front.png",70,100),this.load.spritesheet("gnome_water_back","assets/images/gnome_water_back.png",70,100),this.load.image("gnome_drowning","assets/images/gnome_drowning.png"),this.load.image("control_action","assets/images/control_action.png"),this.load.image("control_left","assets/images/control_left.png"),this.load.image("control_right","assets/images/control_right.png"),this.load.image("control_forward","assets/images/control_forward.png"),this.load.image("play_button","assets/images/play_button.png"),this.load.image("tree-1","assets/images/element_tree-1.png"),this.load.image("tree-2","assets/images/element_tree-2.png"),this.load.image("tree-3","assets/images/element_tree-3.png"),this.load.image("tree-4","assets/images/element_tree-4.png"),this.load.image("tree-5","assets/images/element_tree-5.png"),this.load.image("tree-6","assets/images/element_tree-6.png"),this.load.image("house_ne","assets/images/house_back_right.png"),this.load.image("house_nw","assets/images/house_back_left.png"),this.load.image("house_se","assets/images/house_front_right.png"),this.load.image("house_sw","assets/images/house_front_left.png"),this.load.image("mushrooms","assets/images/mushrooms.png"),this.load.image("rock","assets/images/rock.png"),this.load.image("waterdrop_empty","assets/images/waterdrop_empty.png"),this.load.image("waterdrop_filled","assets/images/waterdrop_filled.png"),this.load.audio("falling_gnome_scream","assets/sound/wilhelm_scream.ogg"),this.load.json("tutorial_level_1","assets/levels/tutorial_level_1.json"),this.load.json("tutorial_level_2","assets/levels/tutorial_level_2.json"),this.load.json("menu_level","assets/levels/menu_level.json"),this.load.json("test","assets/levels/example_level.json")},t.prototype.create=function(){var e=this;this.game.time.events.add(0,function(){e.game.state.start("menu")},this)},t}(Phaser.State);e.PreloadState=t}(States||(States={}));var States;!function(e){var t={font:"32px Arial",fill:"#ff0044",align:"center"},n=function(e){function n(){return e.apply(this,arguments)||this}return __extends(n,e),n.prototype.create=function(){this.game.camera.setPosition(-400,-300);var e=new GameWorld(this.game);e.loadLevel("menu_level"),this.createMenuButton("Continue",0,0,this.continueGame),this.createMenuButton("Start Game",0,40,this.startGame),this.createMenuButton("Options",0,80,this.options)},n.prototype.createMenuButton=function(e,n,o,i){var a=this.game.add.text(n,o,e,t);return a.inputEnabled=!0,a.events.onInputUp.add(i,this),a},n.prototype.startGame=function(){this.game.state.start("play")},n.prototype.continueGame=function(){var e=prompt("Continue from which level?","tutorial_level_2");this.game.state.start("play",!0,!1,e)},n.prototype.options=function(){console.log("options")},n}(Phaser.State);e.MenuState=n}(States||(States={}));var States;!function(e){var t=function(t){function n(){return t.apply(this,arguments)||this}return __extends(n,t),n.prototype.init=function(){this.scale.scaleMode=Phaser.ScaleManager.RESIZE,this.game.camera.bounds=null},n.prototype.preload=function(){this.game.load.image("progressBar","assets/images/progressbar.png"),this.game.load.image("logo","assets/images/logo.png"),this.game.state.add("preload",e.PreloadState),this.game.state.add("menu",e.MenuState),this.game.state.add("play",e.PlayState)},n.prototype.create=function(){this.game.state.start("preload")},n}(Phaser.State);e.BootState=t}(States||(States={}));var Game=function(e){function t(){return e.call(this,"100","100",Phaser.AUTO,"content",null,!0)||this}return __extends(t,e),t.prototype.start=function(){this.state.add("boot",States.BootState,!0)},t}(Phaser.Game);window.codeGarden=new Game;